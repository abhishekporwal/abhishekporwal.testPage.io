ccs_define("logoService",["jquery","babelHelpers","require"],function(a,n,o){"use strict";var i="div[data-logo-hover-loading]",e=function(){function o(e,t){n.classCallCheck(this,o),this.$icon=e.refs.$icon,this.$popup=e.refs.$popup,this.popupId=e.popupId,this.settings=t,this.logEvent=e.logEvent,this.hasIframe=e.hasIframe}return n.createClass(o,[{key:"initIconClick",value:function(){var e=this;this.$icon.on("click",function(){return e.open()})}},{key:"triggerShowEvent",value:function(){a(document).trigger("ccs.logo-shown",{entryId:this.popupId}),this.hoverOpenTime=(new Date).getTime(),this.isPopupOpened=!0;this.dispatchEvent({Action:"hover"})}},{key:"triggerHideEvent",value:function(){a(document).trigger("ccs.logo-hidden",{entryId:this.popupId});var e={Action:"hover-time",Qty:Math.ceil(((new Date).getTime()-this.hoverOpenTime)/1e3)};this.isPopupOpened=!1,this.dispatchEvent(e)}},{key:"dispatchEvent",value:function(e){ccs_cc_log.dispatchEvent(this.logEvent,e)}},{key:"open",value:function(){var e=a.Event("ccsLogoOpen");this.$icon.trigger(e),e.isDefaultPrevented()||(this.hasIframe&&(this.showLoadingIndicator&&this.showLoading(),this.toggleIframeSrc()),this.openPopup(),this.triggerShowEvent())}},{key:"close",value:function(){this.$icon.trigger("ccsLogoClose"),this.hasIframe&&(this.hideLoading(),this.toggleIframeSrc()),this.closePopup(),this.triggerHideEvent()}},{key:"toggleIframeSrc",value:function(){var e=this.$popup.find("iframe"),t=e.parent(),o=e.src?"about:blank":e.attr("data-logo-hover-url");e.detach(),e.attr("src",o),e.appendTo(t)}},{key:"showLoading",value:function(){var e=this,t=this.$popup.find(i);this.showIndicatorTimeout=setTimeout(function(){e.isIndicatorShown=!0,t.show()},1e3)}},{key:"hideLoading",value:function(){this.isIndicatorShown?(this.isIndicatorShown=!1,this.$popup.find(i).hide()):clearTimeout(this.showIndicatorTimeout)}},{key:"openPopup",value:function(){}},{key:"closePopup",value:function(){}},{key:"resize",value:function(){}}]),o}(),d="ccs-logo-ls-popup-top",u="ccs-logo-ls-popup-bottom",v="ccs-logo-ls-popup-left",f="ccs-logo-ls-popup-right",s=function(){function i(e,t,o){n.classCallCheck(this,i),this.$popup=t,this.$icon=e,this.hoverDirection=o}return n.createClass(i,[{key:"init",value:function(){this.collectScreenValues(),this.clearHoverStyles(),this.$popup.css({top:"-99999px",left:"-99999px"}).show(),this.guessHoverDirection();var e="left"===this.hoverDirection||"right"===this.hoverDirection?this.getHoverPositionOnHorizontalAxis():this.getHoverPositionOnVerticalAxis();this.$popup.css({top:e.Top,left:e.Left,visibility:"visible",backgroundPosition:e.arrowBgPositionX+" "+e.arrowBgPositionY})}},{key:"collectScreenValues",value:function(){var e={},t=this.$icon.outerWidth(),o=this.$icon.outerHeight(),i=this.$icon[0].getBoundingClientRect();e.icon={ViewportTop:i.top,ViewportLeft:i.left,Width:t,Height:o,HalfWidth:Math.ceil(t/2),HalfHeight:Math.ceil(o/2)};var n=a(window);e.viewport={Width:window.innerWidth||n.width(),Height:window.innerHeight||n.height(),ScrollTop:n.scrollTop(),ScrollLeft:n.scrollLeft()},e.distanceFromIconBound={Left:e.icon.ViewportLeft,Right:e.viewport.Width-e.icon.ViewportLeft-e.icon.Width,Top:e.icon.ViewportTop,Bottom:e.viewport.Height-e.icon.ViewportTop-e.icon.Height},e.distanceFromIconCenter={Left:e.distanceFromIconBound.Left+e.icon.HalfWidth,Right:e.distanceFromIconBound.Right+e.icon.HalfWidth,Top:e.distanceFromIconBound.Top+e.icon.HalfHeight,Bottom:e.distanceFromIconBound.Bottom+e.icon.HalfHeight},this.screenValues=e}},{key:"clearHoverStyles",value:function(){this.$popup.removeAttr("style").removeClass(d).removeClass(u).removeClass(v).removeClass(f)}},{key:"guessHoverDirection",value:function(){var e,t=this.$popup,o=this.screenValues,i=o.distanceFromIconBound,n=o.viewport,s=o.icon,r=this.hoverDirection||"right";if("left"===r||"right"===r){t.addClass(v),e=t.outerWidth();var c=i.Left+n.ScrollLeft>=e,a=i.Right>=e+16;c||a||(r="top",t.removeClass(v),t.addClass(d))}else{t.addClass(d);var h=t.outerHeight();e=t.outerWidth();var l=document.body.offsetHeight>=n.Height,p=h<=i.Top+n.ScrollTop,u=l?h>=n.ScrollTop-s.ViewportTop-s.Height:h<=n.Height-i.Top-s.HalfHeight,g=i.Left-12>e||i.Right-12>e;(!p&&!u&&g||o.distanceFromIconCenter.Right-16<=0||o.distanceFromIconCenter.Left<=0)&&(r="right",t.removeClass(d),t.addClass(v))}this.hoverDirection=r}},{key:"getHoverPositionOnHorizontalAxis",value:function(){var e,t=this.screenValues.distanceFromIconBound,o=this.screenValues.distanceFromIconCenter,i=this.screenValues.viewport,n=this.screenValues.icon,s=this.$popup.outerWidth(),r=this.$popup.outerHeight(),c=Math.ceil(r/2),a="100%",h=(e=o.Top>=c&&o.Bottom>=c?i.ScrollTop+n.ViewportTop+n.HalfHeight-c:o.Top>=i.Height-n.HalfHeight&&o.Top>=r?i.ScrollTop+n.ViewportTop-r+n.HalfHeight:o.Top<=0?i.ScrollTop+o.Top:o.Top>=r?i.ScrollTop+i.Height-r:i.ScrollTop)+c,l=i.ScrollTop+n.ViewportTop+n.HalfHeight,p="".concat(c-(h-l)-12,"px"),u=s<=t.Left+i.ScrollLeft,g=s<=t.Right;return{Top:e,Left:!u&&g||g&&"right"===this.hoverDirection||!u&&"right"===this.hoverDirection?(a="0%",this.$popup.removeClass(v),this.$popup.addClass(f),i.ScrollLeft+n.ViewportLeft+n.Width):i.ScrollLeft+n.ViewportLeft-s,arrowBgPositionX:a,arrowBgPositionY:p}}},{key:"getHoverPositionOnVerticalAxis",value:function(){var e,t=this.screenValues.distanceFromIconBound,o=this.screenValues.distanceFromIconCenter,i=this.screenValues.viewport,n=this.screenValues.icon,s=this.$popup.outerWidth(),r=this.$popup.outerHeight(),c=Math.ceil(s/2),a="100%",h=(e=o.Left>=c&&o.Right>=c?i.ScrollLeft+n.ViewportLeft+n.HalfWidth-c:o.Left>=c?i.ScrollLeft+i.Width-(s+16):i.ScrollLeft)+c,l=i.ScrollLeft+n.ViewportLeft+n.HalfWidth,p="".concat(c-(h-l)-12,"px");return{Top:r<=t.Top+i.ScrollTop&&"bottom"!==this.hoverDirection?i.ScrollTop+n.ViewportTop-r:(a="0%",this.$popup.removeClass(d),this.$popup.addClass(u),i.ScrollTop+n.ViewportTop+n.Height),Left:e,arrowBgPositionX:p,arrowBgPositionY:a}}}]),i}(),t=function(e){function t(){var e;return n.classCallCheck(this,t),(e=n.possibleConstructorReturn(this,n.getPrototypeOf(t).apply(this,arguments))).$popup.appendTo("body"),e.positionController=new s(e.$icon,e.$popup,e.settings.hoverDirection),e.initIconEvents(),e.initHoverEvents(),e.initLoadingIndicator(),e}return n.inherits(t,e),n.createClass(t,[{key:"initIconEvents",value:function(){var e=this;this.settings.openHoverOnClick?this.initIconClick():(this.$icon.on("mouseenter",function(){return e.onIconMouseEnter()}),this.settings.closeOnMouseLeave&&this.$icon.on("mouseleave",function(){return e.onIconMouseLeave()}))}},{key:"onIconMouseEnter",value:function(){var e=this;this.isPopupOpened&&this.settings.closeOnMouseLeave?clearTimeout(this.closingTimeoutId):this.settings.openHoverOnClick||(this.openingTimeoutId=setTimeout(function(){return e.open()},this.settings.hoverOpenDelay))}},{key:"onIconMouseLeave",value:function(){var e=this;this.isPopupOpened?this.closingTimeoutId=setTimeout(function(){return e.close()},this.settings.hoverCloseDelay):clearTimeout(this.openingTimeoutId)}},{key:"initHoverEvents",value:function(){var e=this;this.settings.closeOnMouseLeave?this.$popup.on({mouseenter:function(){return e.onHoverMouseEnter()},mouseleave:function(){return e.onHoverMouseLeave()}}):this.$popup.on("click","div[data-logo-hover-close-button]",function(){return e.close()})}},{key:"onHoverMouseEnter",value:function(){this.isPopupOpened&&clearTimeout(this.closingTimeoutId)}},{key:"onHoverMouseLeave",value:function(){var e=this;this.closingTimeoutId=setTimeout(function(){return e.close()},this.settings.hoverCloseDelay)}},{key:"openPopup",value:function(){n.get(n.getPrototypeOf(t.prototype),"openPopup",this).call(this),this.resize(),this.$popup.show()}},{key:"closePopup",value:function(){this.$popup.hide()}},{key:"resize",value:function(){this.positionController.init()}},{key:"initLoadingIndicator",value:function(){var t=this;window.addEventListener("message",function(e){t.messageHandler(e)},!1)}},{key:"messageHandler",value:function(e){var t=!0,o={};try{(o=a.parseJSON(e.data)).hoverLoad||(t=!1)}catch(e){t=!1}t&&this.hideLoading(o.hoverLoad)}}]),t}(e),r=function(e){function t(){var e;return n.classCallCheck(this,t),o("Fancybox"),(e=n.possibleConstructorReturn(this,n.getPrototypeOf(t).apply(this,arguments))).config={touch:!1,smallBtn:!1,baseClass:"ccs-logo-lightbox",beforeShow:function(){return e.resize()},afterClose:function(){return e.close()}},e.param=e.$icon.attr("data-logo-param"),e.param?e.initImageConfig():e.initMobileConfig(),e.initIconClick(),e}return n.inherits(t,e),n.createClass(t,[{key:"initImageConfig",value:function(){this.config.type="image",this.config.src=this.param}},{key:"initMobileConfig",value:function(){this.config.type="html",this.config.content=this.$popup,this.resize=this.resizeMobile,this.maxWidth=this.$popup.outerWidth(!0)}},{key:"resizeMobile",value:function(){0!==this.maxWidth&&window.outerWidth>this.maxWidth?this.$popup.outerWidth(this.maxWidth):this.$popup.outerWidth("auto")}},{key:"openPopup",value:function(){a.fancybox.open(this.config)}}]),t}(e),c=function(){function o(e,t){n.classCallCheck(this,o),this.icons=t.find("img[data-logo-icon=true]"),this.settings=e,this.create(),this.initEventsListener()}return n.createClass(o,[{key:"create",value:function(){var c=this;this.icons.each(function(e,t){var o=a(t),i=o.attr("id"),n=o.attr("data-logo-hover-id"),s={logoId:i,popupId:n,refs:{$icon:o,$popup:a("#".concat(n))},hasIframe:"iframe"===o.attr("data-logo-embedding-type"),hoverDirection:c.settings.hoverDirection,showLoadingIndicator:"true"===o.attr("data-logo-show-loading-indicator"),logEvent:o.attr("data-logo-log-event")},r=c.getInstance(o);o.data("ccsLogo",new r(s,c.settings))})}},{key:"getInstance",value:function(e){return"hover"===e.attr("data-logo-display-mode").toLowerCase()?t:r}},{key:"initEventsListener",value:function(){var o=this;this.icons.on("ccsLogoOpen",function(e){if(o.openedLogo)return e.preventDefault(),!1;var t=a(e.currentTarget).data("ccsLogo");o.openedLogo=t}).on("ccsLogoClose",function(){return o.openedLogo=null}),a(window).on("resize orientationchange",function(){o.openedLogo&&o.openedLogo.resize()})}}]),o}();return function(e,t){var o=a("#".concat(e));if(0!==o.length){ccs_util.isMobile()&&(t.openHoverOnClick=!0,t.closeOnMouseLeave=!1);var i=new c(t,o);o.data("logoService",i)}}});
//# sourceMappingURL=LogoService.min.js.map
