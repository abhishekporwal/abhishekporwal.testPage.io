ccs_define("microsoft365",["jquery","ElementQueries","babelHelpers"],function(s,o,a){"use strict";var n="[data-action-context]",e="ccs-logo-ms365-active",i=".ccs-logo-ms365-wrapper",r=".ccs-logo-ms365-inner",p=".ccs-logo-ms365-main-tab",l=".ccs-logo-ms365-sub-tab",d=".ccs-logo-ms365-tabcontent",u=".ccs-logo-ms365-cards",m=".ccs-logo-ms365-specs",t="ccs-logo-ms365-footer-text",c="[data-logo-addtocart]",v="[data-logo-dynamic-price]",f="ccs-ms365-promo-fake-atc",g="data-promo",C="ccs-ms365-promo",y="data-show-popup",k={banner:"ccs-ms365-promo-banner",top:"ccs-ms365-promo-banner-top",bottom:"ccs-ms365-promo-banner-bottom"},h={popup:"ccs-ms365-promo-popup",show:"ccs-ms365-popup-show",modalWindow:"ccs-ms365-promo-modal",closeBtn:"ccs-ms365-promo-close",content:"ccs-ms365-promo-content",picture:"ccs-ms365-promo-picture",title:"ccs-ms365-promo-title",description:"ccs-ms365-promo-desc",copyCodeBtn:"ccs-ms365-promo-copy-code-btn",couponCode:"ccs-ms365-promo-coupon-code"},b=function(){function c(o,t){a.classCallCheck(this,c),this.o=o,this.$ep=t,this.create()}return a.createClass(c,[{key:"create",value:function(){var t=this;t.$ep.on("click",n,function(o){return t.logEvent(o.target)}),t.$ep.on("click",p,function(o){return t.mainTabClick(o.target)}),t.$ep.on("click",l,function(o){return t.contentTabClick(o.target)})}},{key:"logEvent",value:function(o){var t={ActionContext:s(o).data("action-context")};ccs_cc_log.dispatchEvent(this.o.logEvent,t)}},{key:"mainTabClick",value:function(o){var t=s(o);t.hasClass(e)||(t.parent().find(".".concat(e)).toggleClass(e),t.toggleClass(e).closest(i).find(d).toggleClass(e))}},{key:"contentTabClick",value:function(o){var t=s(o);t.hasClass(e)||t.closest(d).find("".concat(l,", ").concat(u,", ").concat(m)).toggleClass(e)}}]),c}(),P=function(o){function e(o,t){var c;a.classCallCheck(this,e),(c=a.possibleConstructorReturn(this,a.getPrototypeOf(e).apply(this,arguments))).promo=o.promo,c.$contents=t.find(r),c.$footer=c.renderFooter(),c.$container=s(".".concat(C)).attr(y,o.promo.showPopup).prependTo(c.$footer);var n=t.find(v);return c.applyDiscount(n),c.renderPromoElements(),c.initPromoEvents(),c.$ep.attr(g,!0),c}return a.inherits(e,o),a.createClass(e,[{key:"renderFooter",value:function(){var o='<div class="ccs-logo-ms365-footer">\n\t<div class="'.concat(C,'"></div>\n\t<div class="').concat(t,'">').concat(this.promo.footerText,"</div>\n</div>");return s(o).appendTo(this.$contents)}},{key:"applyDiscount",value:function(o){var a=this;s.each(o,function(o,t){var c=s(t),n=c.text().trim();if(0!==n.length){var e=a.getDiscountPrice(n,a.promo.discountValue);e&&c.empty().append('<div class="ccs-ms365-current-price">'.concat(n,"</div>")).append('<div class="ccs-ms365-promo-price">'.concat(e,"</div>"))}})}},{key:"getDiscountPrice",value:function(o,t){var c,n=(o=o.replace(",",".")).match(/\d+\.\d+|\d+/);return n?t?((c=t.relative?n*(1-t.relative):n-t.absolute)%1!=0&&(c=c.toFixed(2)),!(c<=0)&&o.replace(n,c)):o:""}},{key:"renderPromoElements",value:function(){var o=this;(o.renderBanner(k,o.promo.bannerTexts).appendTo(o.$container),o.promo.showPopup)&&(o.renderPopup(h,o.promo.popupTexts).appendTo(o.$contents.parent()),o.renderFakeATC())}},{key:"renderBanner",value:function(o,t){var c='<div class="'.concat(o.banner,'">\n\t<div class="').concat(o.top,'">').concat(t.top,'</div>\n\t<div class="').concat(o.bottom,'">').concat(t.bottom,"</div>\n</div>");return s(c)}},{key:"renderPopup",value:function(o,t){var c='<div class="'.concat(o.popup,'">\n\t<div class="').concat(o.modalWindow,'">\n\t\t<div class="').concat(o.closeBtn,'"></div>\n\t\t<div class="').concat(o.content,'">\n\t\t\t<div class="').concat(o.title,'">').concat(t.title,'</div>\n\t\t\t<input class="').concat(o.couponCode,'" value="').concat(t.couponCode,'" type="text" readonly contenteditable="false">\n\t\t\t<div class="').concat(o.description,'">').concat(t.description,'</div>\n\t\t\t<a class="').concat(o.copyCodeBtn,'">').concat(t.copyCodeBtn,'</a>\n\t\t</div>\n\t\t<div class="').concat(o.picture,'"></div>\n\t</div>\n</div>');return s(c)}},{key:"renderFakeATC",value:function(){var o=this.$ep.find(c);if(0!==o.length){var t=s("<div>").addClass(f);o.before(t)}}},{key:"initPromoEvents",value:function(){var t=this;t.$ep.on("click",".".concat(h.copyCodeBtn),function(){return t.logEventPromo()}),t.$ep.on("click","[".concat(y,"]"),function(){return t.showPopup()}),t.$ep.on("click",".".concat(h.closeBtn),function(o){return t.closePopup(s(o.target))}),t.$ep.on("click",".".concat(f),function(o){t.showPopup(),t.showPopupOnAddToCartClick(s(o.target))}),t.$ep.on("click",".".concat(h.copyCodeBtn),function(o){t.copyCodeToClipboard(),t.closePopup(s(o.target))}),t.$ep.on("ccsPrice.success",v,function(o){return t.applyDiscount(s(o.target))})}},{key:"logEventPromo",value:function(){ccs_cc_log.dispatchEvent(this.o.logEvent,{Action:"click",ActionContext:"copy-to-clipboard"})}},{key:"showPopup",value:function(){this.$ep.find(".".concat(h.popup)).addClass(h.show)}},{key:"showPopupOnAddToCartClick",value:function(o){var t=this,c=s(o);t.$ep.find(".".concat(h.closeBtn)).off("click.ccs_Microsoft365Promo").one("click.ccs_Microsoft365Promo",function(o){t.triggerClickToATC(c),t.closePopup(s(o.target))}),t.$ep.find(".".concat(h.copyCodeBtn)).off("click.ccs_Microsoft365Promo").one("click.ccs_Microsoft365Promo",function(o){o.stopPropagation(),t.copyCodeToClipboard(),t.triggerClickToATC(c),t.closePopup(s(o.target))})}},{key:"closePopup",value:function(o){o.closest(".".concat(h.popup)).removeClass(h.show)}},{key:"triggerClickToATC",value:function(o){var t=o.next(),c=t.find("input[type=submit]").length?"input[type=submit]":"a, button",n=t.find(c)[0];n&&n.click()}},{key:"copyCodeToClipboard",value:function(){var o=this.$ep.find(".".concat(h.couponCode));o.focus().select(),document.execCommand("copy")||this.iosCopyFallback(o),o.blur()}},{key:"iosCopyFallback",value:function(o){var t=o[0],c=t.contentEditable,n=t.readOnly;t.contentEditable=!0,t.readOnly=!0;var e=document.createRange();e.selectNodeContents(t);var a=window.getSelection();a.removeAllRanges(),a.addRange(e),t.setSelectionRange(0,999999),t.contentEditable=c,t.readOnly=n,document.execCommand("copy")}}]),e}(b);return function(o){var t=s("#".concat(o.entryPointId));if(0!==t.length){var c=o.promo?new P(o,t):new b(o,t);t.data("microsoft365",c)}}});
//# sourceMappingURL=microsoft365.min.js.map
